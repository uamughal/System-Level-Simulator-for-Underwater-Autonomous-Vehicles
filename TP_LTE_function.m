function result = TP_LTE_function(SINR,antenna_configuration,type)%This function calculates the TP according to Holma, Toskala: LTE for UMTS, Fig. 9.2if strcmp(type,'downlink')    if (antenna_configuration==1) %SISO configuration        BW_eff=0.56;        SNR_eff=2.0;        TP_max=4.1;        SINR_min=10^(-10/10);    elseif (antenna_configuration==2) %SIMO (1x2) configuration        BW_eff=0.62;        SNR_eff=1.8;        TP_max=4.1;        SINR_min=10^(-10/10);    elseif (antenna_configuration==3) %Closed-loop MIMO (2x2) configuration        BW_eff=0.66;        SNR_eff=1.1;        TP_max=4.1;        SINR_min=10^(-10/10);    end        SINR_max=(2^(TP_max/BW_eff)-1)*SNR_eff;        result=zeros(size(SINR));        ind= SINR<SINR_min;    result(ind)=0;        ind= SINR>SINR_max;    result(ind)=TP_max;        ind= find(SINR>=SINR_min & SINR<=SINR_max);    result(ind)=BW_eff*log2(1+SINR(ind)/SNR_eff);elseif strcmp(type,'uplink')    BW_eff=0.4;    SNR_eff=1;    TP_max=2;    SINR_min=10^(-10/10);    SINR_max=(2^(TP_max/BW_eff)-1)*SNR_eff;        result=zeros(size(SINR));    ind=SINR<SINR_min;    result(ind)=0;        ind=SINR>SINR_max;    result(ind)=TP_max;        ind= find(SINR>=SINR_min & SINR<=SINR_max);    result(ind)=BW_eff*log2(1+SINR(ind)/SNR_eff);end